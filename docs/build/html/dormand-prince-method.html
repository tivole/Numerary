

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Dormand-Prince Method &mdash; Numerary 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Linear Regression" href="linear-regression.html" />
    <link rel="prev" title="Newton’s Method" href="newton-method.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Numerary
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Root finding</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="root-bisection-method.html">Bisection Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="root-secant-method.html">Secant Method</a></li>
</ul>
<p class="caption"><span class="caption-text">Integral</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="integral-approximation-simpson.html">Integral Approximation - Simpson’s Rule</a></li>
</ul>
<p class="caption"><span class="caption-text">Minimum finding</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="minimum-bisection-method.html">Bisection Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="minimum-golden-ratio-method.html">Golden Ratio Method</a></li>
</ul>
<p class="caption"><span class="caption-text">Maximum finding</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="maximum-bisection-method.html">Bisection Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="maximum-golden-ratio-method.html">Golden Ratio Method</a></li>
</ul>
<p class="caption"><span class="caption-text">Linear System of Equations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gauss-elimination-method.html">Gauss Elimination Method</a></li>
</ul>
<p class="caption"><span class="caption-text">Nonlinear System of Equations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="newton-method.html">Newton’s Method</a></li>
</ul>
<p class="caption"><span class="caption-text">Ordinary Differential Equations</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dormand-Prince Method</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#definition">Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Regression</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="linear-regression.html">Linear Regression</a></li>
</ul>
<p class="caption"><span class="caption-text">Interpolation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="lagrange-interpolation.html">Lagrange’s Interpolation</a></li>
</ul>
<p class="caption"><span class="caption-text">Differentiation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="differentiation-first-order.html">Numerical differentiation. Calculation of the first derivative.</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Numerary</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Dormand-Prince Method</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/dormand-prince-method.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dormand-prince-method">
<h1>Dormand-Prince Method<a class="headerlink" href="#dormand-prince-method" title="Permalink to this headline">¶</a></h1>
<div class="section" id="definition">
<h2>Definition<a class="headerlink" href="#definition" title="Permalink to this headline">¶</a></h2>
<p>The one step calculation in the Dormand-Prince method is done as the following.</p>
<div class="math notranslate nohighlight">
\begin{equation}
    \begin{aligned}
        k_{1} &amp;=h f\left(t_{k}, y_{k}\right), \\
        k_{2} &amp;=h f\left(t_{k}+\frac{1}{5} h, y_{k}+\frac{1}{5} k_{1}\right), \\
        k_{3} &amp;=h f\left(t_{k}+\frac{3}{10} h, y_{k}+\frac{3}{40} k_{1}+\frac{9}{40} k_{2}\right), \\
        k_{4} &amp;=h f\left(t_{k}+\frac{4}{5} h, y_{k}+\frac{44}{45} k_{1}-\frac{56}{15} k_{2}+\frac{32}{9} k_{3}\right), \\
        k_{5} &amp;=h f\left(t_{k}+\frac{8}{9} h, y_{k}+\frac{19372}{6561} k_{1}-\frac{25360}{2187} k_{2}+\frac{64448}{6561} k_{3}-\frac{212}{729} k_{4}\right), \\
        k_{6} &amp;=h f\left(t_{k}+h, y_{k}+\frac{9017}{3168} k_{1}-\frac{355}{33} k_{2}-\frac{46732}{5247} k_{3}+\frac{49}{176} k_{4}-\frac{5103}{18656} k_{5}\right), \\
        k_{7} &amp;=h f\left(t_{k}+h, y_{k}+\frac{35}{384} k_{1}+\frac{500}{1113} k_{3}+\frac{125}{192} k_{4}-\frac{2187}{6784} k_{5}+\frac{11}{84} k_{6}\right).
    \end{aligned}
\end{equation}</div><p>Then the next step value <span class="math notranslate nohighlight">\(y_{k+1}\)</span> is calculated as</p>
<div class="math notranslate nohighlight">
\begin{equation}
    y_{k+1}=y_{k}+\frac{35}{384} k_{1}+\frac{500}{1113} k_{3}+\frac{125}{192} k_{4}-\frac{2187}{6784} k_{5}+\frac{11}{84} k_{6}.
\end{equation}</div><p>This is a calculation by Runge-Kutta method of order 4. We have to be aware that we do not use <span class="math notranslate nohighlight">\(k_2\)</span>, though it is used to calculate <span class="math notranslate nohighlight">\(k_3\)</span> and so on.</p>
<p>Next, we will calculate the next step value <span class="math notranslate nohighlight">\(z_{k+1}\)</span> by Runge-Kutta method of order 5 as</p>
<div class="math notranslate nohighlight">
\begin{equation}
    z_{k+1}=y_{k}+\frac{5179}{57600} k_{1}+\frac{7571}{16695} k_{3}+\frac{393}{640} k_{4}-\frac{92097}{339200} k_{5}+\frac{187}{2100} k_{6}+\frac{1}{40} k_{7}
\end{equation}</div><p>We calculate the difference of the two next values <span class="math notranslate nohighlight">\(\left|z_{k+1}-y_{k+1}\right|\)</span>.</p>
<div class="math notranslate nohighlight">
\begin{equation}
    \left|z_{k+1}-y_{k+1}\right|=\left|\frac{71}{57600} k_{1}-\frac{71}{16695} k_{3}+\frac{71}{1920} k_{4}-\frac{17253}{339200} k_{5}+\frac{22}{525} k_{6}-\frac{1}{40} k_{7}\right|
\end{equation}</div><p>This is considered as the error in <span class="math notranslate nohighlight">\(y_{k+1}\)</span>. We calculate the optimal time interval <span class="math notranslate nohighlight">\(h_{opt}\)</span> as,</p>
<div class="math notranslate nohighlight">
\begin{equation}
    s =\left(\frac{\varepsilon h}{2\left|z_{k+1}-y_{k+1}\right|}\right)^{\frac{1}{5}}, \\
    h_{o p t} =s h,
\end{equation}</div><p>where <span class="math notranslate nohighlight">\(h\)</span> in the right side is the old time interval. In practical programming, this new <span class="math notranslate nohighlight">\(h_{opt}\)</span> will be used in the next step of the calculation, though the author thinks it should be also used in the present calculation when it is very small, half or smaller for example.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Imagine that we want to minimize the following differential equation:</p>
<div class="math notranslate nohighlight">
\begin{equation}
    y' = 3 \frac{y}{x} + x^3 + x, y(1) = 3
\end{equation}</div><p>Then the code will look like this:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// example_dorpi.cpp</span>

<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;../src/numerary.hpp&quot; // Numerary library</span><span class="cp"></span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">numerary</span><span class="p">;</span>

<span class="cm">/* Equation to solve */</span>
<span class="kt">double</span> <span class="nf">equation</span><span class="p">(</span><span class="kt">double</span> <span class="n">x</span><span class="p">,</span> <span class="kt">double</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mf">3.0</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* The main function */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

    <span class="kt">double</span> <span class="o">*</span><span class="n">y</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">double</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="kt">double</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">;</span>
    <span class="kt">short</span> <span class="kt">int</span> <span class="n">is_solved</span><span class="p">;</span>

    <span class="c1">// Initial point</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

    <span class="c1">// Point where we want calculate y(x)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>

    <span class="c1">// Step size</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>

    <span class="n">is_solved</span> <span class="o">=</span> <span class="n">Numerary</span><span class="o">::</span><span class="n">ordinary_differential_equations</span><span class="p">(</span><span class="n">equation</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;dorpi_4_5&quot;</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">is_solved</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Solved!&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;y(&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;) = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Method not allowed!&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">delete</span><span class="p">[]</span> <span class="n">y</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="linear-regression.html" class="btn btn-neutral float-right" title="Linear Regression" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="newton-method.html" class="btn btn-neutral float-left" title="Newton’s Method" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Kamran Asgarov

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>